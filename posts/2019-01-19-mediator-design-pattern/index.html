<!doctype html><html lang=fa class="wf-firasans-n4-active wf-active"><head><link href=http://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=generator content="Hugo 0.58.3"><title>الگوهای طراحی - Mediator &middot; Moien Tajik&#39;s Blog | وبلاگ معین تاجیک</title><meta content="Moien Tajik" property=og:site_name><meta content="الگوهای طراحی - Mediator - Moien Tajik's Blog | وبلاگ معین تاجیک" property=og:title><meta content="الگوی طراحی Mediator نحوه ی ارتباط چند object را در داخل خود کپسوله و مشخص میکند." property=og:description><meta content=/img/posts/2019-01-18-Mediator-Design-Pattern/mediator.jpg property=og:image><link href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i|Roboto+Mono:300,300i,400,400i" rel=stylesheet><style media=print>.sidebar{display:none!important}.container,.content{width:100%;float:none;display:initial;margin:0 auto}.container{padding-left:1rem;padding-right:1rem}</style><link rel=stylesheet href=/css/poole.css><link rel=stylesheet href=/css/hyde.css><link rel=stylesheet href=/css/custom.css><script defer src=https://use.fontawesome.com/releases/v5.0.13/js/all.js integrity=sha384-xymdQtn1n3lH2wcu0qhcdaOpQwyoarkgLVxC/wZ5q7h9gHtxICrpcaSUfygqZGOe crossorigin=anonymous></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css><script src=/js/tarikh.js></script><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/favicon.png></head><body class=theme-base-te><div class=sidebar><div class="container text-center"><div class="sidebar-about text-center"><img src=/img/Moien%20Tajik.png alt="Moien Tajik's Image" class="img-circle headshot center">
<a href=/ class=no-decoration><h1 class=brand>معین تاجیک</h1></a><p class=lead>توسعه دهنده نرم افزار</p></div><div><ul class=sidebar-nav><li><a href=/><span>خانه</span></a></li><li><a href=/posts/><span>مقالات</span></a></li><li><a href=/tags/><span>تگ ها</span></a></li><li><a href=https://moientajik.github.io/><span>درباره من</span></a></li></li></ul></div><p><section class="row text-center"><a href=https://twitter.com/MoienTajik><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a>&nbsp;<a href=https://github.com/MoienTajik><i class="fab fa-github fa-lg" aria-hidden=true></i></a>
&nbsp;<a href=https://linkedin.com/in/MoienTajik><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a>
&nbsp;<a href=https://stackoverflow.com/story/moientajik><i class="fab fa-stack-overflow fa-lg" aria-hidden=true></i></a>
&nbsp;<a href=https://medium.com/@MoienTajik><i class="fab fa-medium fa-lg" aria-hidden=true></i></a>
&nbsp;<a href=https://keybase.io/moientajik><i class="fab fa-keybase fa-lg" aria-hidden=true></i></a>
&nbsp;<a href=mailto:moientajik@hotmail.com><i class="fas fa-at fa-lg" aria-hidden=true></i></a></section></p><p class=copyright>&copy; 2019 Moien Tajik.
<a href=https://creativecommons.org/licenses/by/4.0>All rights reserved</a>.<br>Built with <a href=https://gohugo.io/>Hugo</a> &amp; <a href=https://github.com/htr3n/hyde-hyde>hyde-hyde</a></p></div><div></div></div><div class="content container"><div class=post dir=rtl><h1 class=postTitle>الگوهای طراحی - Mediator</h1><div class="col-sm-12 col-md-12"><span class="text-left post-date meta"><i class="fas fa-calendar-alt"></i><span id=shamsiDate class=subtitle></span><script>let shamsiDate=JDate("01/19/2019").toString();document.getElementById("shamsiDate").innerText="تاریخ انتشار : "+shamsiDate;</script><br><i class="fas fa-tags"></i>تگ ها :
,
<a class=meta href=/tags/c>c#</a>
,
<a class=meta href=/tags/designpatterns>designpatterns</a>
,
<a class=meta href=/tags/mediator>mediator</a>
,
<a class=meta href=/tags/patterns>patterns</a><br><i class="fas fa-clock"></i><span class=subtitle>زمان حدودی مطالعه : 3 دقیقه</span></span></div><hr><p>الگوی طراحی Mediator نحوه ی ارتباط چند object را در داخل خود کپسوله و مشخص میکند.</p><p><img src=/img/posts/2019-01-18-Mediator-Design-Pattern/mediator.jpg alt="Mediator Pattern"></p><p>یک مثال واقعی از این الگو :</p><p>برج مراقبت یک فرودگاه را در نظر بگیرید. این بخش از تمامی هواپیماهایی که تردد میکنند باخبر بوده و وظیفه مدیریت پرواز آن ها را بر عهده داشته و اجازه فرود و پرواز آن ها را صادر میکند.
در صورتی که اجازه فرود داده نشود ، هواپیما اجازه به نشستن ندارد.</p><p>در ادامه سناریوی بالا را داخل کد پیاده سازی میکنیم :</p><p>در ابتدا interface ای بنام IAirTrafficControl (برج مراقبت) میسازیم که این اینترفیس متدی بنام SendMessage دارد که وظیفه ی ارسال پیام از یک هواپیما به هواپیمای دیگر و ایجاد ارتباط بین آن ها و همچنین افزودن هواپیماها به خود را برعهده دارد :</p><pre><code class=language-C#>public interface IAirTrafficControl
{
    void AddAirplanes(params AirplaneBase[] airplanes);

    void SendMessage(string message, AirplaneBase messageProducerAirplane);
}
</code></pre><p>همه ی هواپیماها از کلاس abstract ای بنام AirplaneBase ارث بری میکنند که این کلاس برای ایجاد شدن ، بعنوان ورودی به یک IAirTrafficControl نیاز دارد :</p><pre><code class=language-Java>public abstract class AirplaneBase
{
    protected readonly IAirTrafficControl AirTrafficControl;

    public AirplaneBase(IAirTrafficControl airTrafficControl)
    {
        AirTrafficControl = airTrafficControl;
    }

    public abstract void Send(string message);

    public abstract void Notify(string message);
}
</code></pre><p>این کلاس دارای 2 متد Send و Notify است.
متد Send وظیفه ارسال یک پیام از هواپیمایی به هواپیمای دیگر و متد Notify وظیفه اعلام دریافت پیام از هواپیما دیگر را بر عهده دارد.</p><p>سپس 2 هواپیما که AirplaneBase را پیاده سازی کرده اند را ایجاد میکنیم :</p><pre><code class=language-C#>public class AirbusAirplane : AirplaneBase
{
    public AirbusAirplane(IAirTrafficControl airTrafficControl) : base(airTrafficControl)
    {
    }

    public override void Send(string message)
    {
        Console.WriteLine(&quot;Airbus airplane sends message: &quot; + message);
        AirTrafficControl.SendMessage(message, this);
    }

    public override void Notify(string message)
    {
        Console.WriteLine(&quot;Airbus airplane gets message: &quot; + message);
    }
}

public class BoeingAirplane : AirplaneBase
{
    public BoeingAirplane(IAirTrafficControl airTrafficControl) : base(airTrafficControl)
    {
    }

    public override void Send(string message)
    {
        Console.WriteLine(&quot;Boeing airplane sends message: &quot; + message);
        AirTrafficControl.SendMessage(message, this);
    }

    public override void Notify(string message)
    {
        Console.WriteLine(&quot;Boeing airplane gets message: &quot; + message);
    }
}
</code></pre><p>در نهایت به یک Concrete Class که IAirTrafficControl را پیاده سازی کرده و داخل خود لیست هواپیماها را داشته و ارتباط بین آن ها را ایجاد کند نیاز داریم ; این کلاس اصلی ترین کلاس در این الگوست که مشخص میکند ارتباط بین هواپیما ها چگونه باید صورت گیرد :</p><pre><code class=language-C#>// This is our Mediator which maintains communications.
public class MehrabadAirTrafficControl : IAirTrafficControl
{
    readonly List&lt;AirplaneBase&gt; _airplanes = new List&lt;AirplaneBase&gt;();

    public void AddAirplanes(params AirplaneBase[] airplanes)
    {
        _airplanes.AddRange(airplanes);
    }

    public void SendMessage(string message, AirplaneBase messageProducerAirplane)
    {
        List&lt;AirplaneBase&gt; otherAirplanes = _airplanes
            .Where(airplane =&gt; airplane != messageProducerAirplane)
            .ToList();

        otherAirplanes.ForEach(airplane =&gt; airplane.Notify(message));
    }
}
</code></pre><p>در نهایت به این صورت میتوانیم برنامه خود را تست کنیم :</p><pre><code class=language-C#>public static class Program
{
    static async Task Main()
    {
        IAirTrafficControl mehrabadAirTrafficControl = new MehrabadAirTrafficControl();

        AirplaneBase airbusAirplane = new AirbusAirplane(mehrabadAirTrafficControl);
        AirplaneBase boeingAirplane = new BoeingAirplane(mehrabadAirTrafficControl);

        mehrabadAirTrafficControl.AddAirplanes(airbusAirplane, boeingAirplane);

        airbusAirplane.Send(&quot;Can we land right now ?&quot;);
        Console.WriteLine(&quot;----------&quot;);

        boeingAirplane.Send(&quot;No! We're landing, wait ...&quot;);
        Console.WriteLine(&quot;----------&quot;);

        // Demonstrate landing ...
        Console.WriteLine(&quot;Boeing is landing ...&quot;);
        await Task.Delay(TimeSpan.FromSeconds(3));
        Console.WriteLine(&quot;----------&quot;);

        boeingAirplane.Send(&quot;We landed.&quot;);
        Console.WriteLine(&quot;----------&quot;);

        airbusAirplane.Send(&quot;OK, We're going to land ...&quot;);
        Console.WriteLine(&quot;----------&quot;);

        boeingAirplane.Send(&quot;Good luck.&quot;);

        // Results =&gt;
        // Airbus airplane sends message: Can we land right now ?
        // Boeing airplane gets message: Can we land right now ?
        // ----------
        // Boeing airplane sends message: No! We're landing, wait ...
        // Airbus airplane gets message: No! We're landing, wait ...
        // ----------
        // Boeing is landing ...
        // ----------
        // Boeing airplane sends message: We landed.
        // Airbus airplane gets message: We landed.
        // ----------
        // Airbus airplane sends message: OK, We're going to land ...
        // Boeing airplane gets message: OK, We're going to land ...
        // ----------
        // Boeing airplane sends message: Good luck.
        // Airbus airplane gets message: Good luck.
    }
}
</code></pre><p><strong>[ گیتهاب پروژه ]</strong> : <a href=https://github.com/MoienTajik/DesignPatterns-Mediator>https://github.com/MoienTajik/DesignPatterns-Mediator</a></p></div><hr><div class=footer><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script type=text/javascript>hljs.configure({languages:[]});hljs.initHighlightingOnLoad();</script><h2 dir=rtl>نظرات</h2><div id=disqus_thread></div><script type=text/javascript>(function(){if(location.hostname==="localhost"||location.hostname==="127.0.0.1"||location.hostname===""){return;}
var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;var disqus_shortname='moientajik';dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></div></body></html>